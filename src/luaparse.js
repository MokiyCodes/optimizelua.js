!function(e,t,n){"use strict";var r={function:!0,object:!0},a=r[typeof exports]&&exports&&!exports.nodeType&&exports,i=r[typeof module]&&module&&!module.nodeType&&module,o=a&&i&&"object"==typeof global&&global,c=i&&i.exports===a&&a;!o||o.global!==o&&o.window!==o&&o.self!==o||(e=o),"function"==typeof define&&"object"==typeof define.amd&&define.amd?(define(["exports"],n),a&&c&&n(i.exports)):n(a&&i?c?i.exports:a:e.luaparse={})}(this,0,function(e){"use strict";var t,n,r,a;e.version="0.2.1";var i=e.defaultOptions={wait:!1,comments:!0,scope:!1,locations:!1,ranges:!1,onCreateNode:null,onCreateScope:null,onDestroyScope:null,onLocalDeclaration:null,luaVersion:"5.1",extendedIdentifiers:!1},o=1,c=2,s=4,u=8,l=16,f=32,p=64,d=128,h=256;e.tokenTypes={EOF:o,StringLiteral:c,Keyword:s,Identifier:u,NumericLiteral:l,Punctuator:f,BooleanLiteral:p,NilLiteral:d,VarargLiteral:h};var m=e.errors={unexpected:"unexpected %1 '%2' near '%3'",expected:"'%1' expected near '%2'",expectedToken:"%1 expected near '%2'",unfinishedString:"unfinished string near '%1'",malformedNumber:"malformed number near '%1'",invalidVar:"invalid left-hand side of assignment near '%1'",decimalEscapeTooLarge:"decimal escape too large near '%1'",invalidEscape:"invalid escape sequence near '%1'",hexadecimalDigitExpected:"hexadecimal digit expected near '%1'",braceExpected:"missing '%1' near '%2'",tooLargeCodepoint:"UTF-8 value too large near '%1'",unfinishedLongString:"unfinished long string (starting at line %1) near '%2'",unfinishedLongComment:"unfinished long comment (starting at line %1) near '%2'",ambiguousSyntax:"ambiguous syntax (function call x new statement) near '%1'"},v=e.ast={labelStatement:function(e){return{type:"LabelStatement",label:e}},breakStatement:function(){return{type:"BreakStatement"}},gotoStatement:function(e){return{type:"GotoStatement",label:e}},returnStatement:function(e){return{type:"ReturnStatement",arguments:e}},ifStatement:function(e){return{type:"IfStatement",clauses:e}},ifClause:function(e,t){return{type:"IfClause",condition:e,body:t}},elseifClause:function(e,t){return{type:"ElseifClause",condition:e,body:t}},elseClause:function(e){return{type:"ElseClause",body:e}},whileStatement:function(e,t){return{type:"WhileStatement",condition:e,body:t}},doStatement:function(e){return{type:"DoStatement",body:e}},repeatStatement:function(e,t){return{type:"RepeatStatement",condition:e,body:t}},localStatement:function(e,t){return{type:"LocalStatement",variables:e,init:t}},assignmentStatement:function(e,t){return{type:"AssignmentStatement",variables:e,init:t}},callStatement:function(e){return{type:"CallStatement",expression:e}},functionStatement:function(e,t,n,r){return{type:"FunctionDeclaration",identifier:e,isLocal:n,parameters:t,body:r}},forNumericStatement:function(e,t,n,r,a){return{type:"ForNumericStatement",variable:e,start:t,end:n,step:r,body:a}},forGenericStatement:function(e,t,n){return{type:"ForGenericStatement",variables:e,iterators:t,body:n}},chunk:function(e){return{type:"Chunk",body:e}},identifier:function(e){return{type:"Identifier",name:e}},literal:function(e,t,n){return{type:e=e===c?"StringLiteral":e===l?"NumericLiteral":e===p?"BooleanLiteral":e===d?"NilLiteral":"VarargLiteral",value:t,raw:n}},tableKey:function(e,t){return{type:"TableKey",key:e,value:t}},tableKeyString:function(e,t){return{type:"TableKeyString",key:e,value:t}},tableValue:function(e){return{type:"TableValue",value:e}},tableConstructorExpression:function(e){return{type:"TableConstructorExpression",fields:e}},binaryExpression:function(e,t,n){return{type:"and"===e||"or"===e?"LogicalExpression":"BinaryExpression",operator:e,left:t,right:n}},unaryExpression:function(e,t){return{type:"UnaryExpression",operator:e,argument:t}},memberExpression:function(e,t,n){return{type:"MemberExpression",indexer:t,identifier:n,base:e}},indexExpression:function(e,t){return{type:"IndexExpression",base:e,index:t}},callExpression:function(e,t){return{type:"CallExpression",base:e,arguments:t}},tableCallExpression:function(e,t){return{type:"TableCallExpression",base:e,arguments:t}},stringCallExpression:function(e,t){return{type:"StringCallExpression",base:e,argument:t}},comment:function(e,t){return{type:"Comment",value:e,raw:t}}};function y(e){if(ce){var t=se.pop();t.complete(),t.bless(e)}return n.onCreateNode&&n.onCreateNode(e),e}var g,b,x,S,C,E,A,w,k,L,O,I=Array.prototype.slice,N=(Object.prototype.toString,function(e,t){for(var n=0,r=e.length;n<r;++n)if(e[n]===t)return n;return-1});function T(e){var t=I.call(arguments,1);return e=e.replace(/%(\d)/g,function(e,n){return""+t[n-1]||""})}function D(e){return Object.create?Object.create(e,{line:{writable:!0,value:e.line},index:{writable:!0,value:e.index},column:{writable:!0,value:e.column}}):e}function V(e){var t,n,r=T.apply(null,I.call(arguments,1));throw void 0!==e.line?(n=e.range[0]-e.lineStart,(t=D(new SyntaxError(T("[%1:%2] %3",e.line,n,r)))).line=e.line,t.index=e.range[0],t.column=n):(n=g-w+1,(t=D(new SyntaxError(T("[%1:%2] %3",A,n,r)))).index=g,t.line=A,t.column=n),t}function j(e,t){V(t,m.expectedToken,e,t.value)}function G(e){var t=S.value;if(void 0!==e.type){var n;switch(e.type){case c:n="string";break;case s:n="keyword";break;case u:n="identifier";break;case l:n="number";break;case f:n="symbol";break;case p:n="boolean";break;case d:return V(e,m.unexpected,"symbol","nil",t)}return V(e,m.unexpected,n,e.value,t)}return V(e,m.unexpected,"symbol",e,t)}function K(){for(P();45===t.charCodeAt(g)&&45===t.charCodeAt(g+1);)q(),P();if(g>=r)return{type:o,value:"<eof>",line:A,lineStart:w,range:[g,g]};var e=t.charCodeAt(g),i=t.charCodeAt(g+1);if(E=g,function(e){return e>=65&&e<=90||e>=97&&e<=122||95===e||!!(n.extendedIdentifiers&&e>=128)}(e))return function(){var e,n;for(;_(t.charCodeAt(++g)););!function(e){switch(e.length){case 2:return"do"===e||"if"===e||"in"===e||"or"===e;case 3:return"and"===e||"end"===e||"for"===e||"not"===e;case 4:return"else"===e||"then"===e||!(!a.labels||a.contextualGoto)&&"goto"===e;case 5:return"break"===e||"local"===e||"until"===e||"while"===e;case 6:return"elseif"===e||"repeat"===e||"return"===e;case 8:return"function"===e}return!1}(e=B(t.slice(E,g)))?"true"===e||"false"===e?(n=p,e="true"===e):"nil"===e?(n=d,e=null):n=u:n=s;return{type:n,value:e,line:A,lineStart:w,range:[E,g]}}();switch(e){case 39:case 34:return function(){var e,n=t.charCodeAt(g++),a=A,i=w,o=g,s="";for(;g<r&&(e=t.charCodeAt(g++),n!==e);)92===e?(s+=B(t.slice(o,g-1))+U(),o=g):(g>=r||Y(e))&&(s+=t.slice(o,g-1),V({},m.unfinishedString,s+String.fromCharCode(e)));return s+=B(t.slice(o,g-1)),{type:c,value:s,line:a,lineStart:i,lastLine:A,lastLineStart:w,range:[E,g]}}();case 48:case 49:case 50:case 51:case 52:case 53:case 54:case 55:case 56:case 57:return R();case 46:return Z(i)?R():46===i?46===t.charCodeAt(g+2)?{type:h,value:"...",line:A,lineStart:w,range:[E,g+=3]}:M(".."):M(".");case 61:return M(61===i?"==":"=");case 62:return a.bitwiseOperators&&62===i?M(">>"):M(61===i?">=":">");case 60:return a.bitwiseOperators&&60===i?M("<<"):M(61===i?"<=":"<");case 126:if(61===i)return M("~=");if(!a.bitwiseOperators)break;return M("~");case 58:return a.labels&&58===i?M("::"):M(":");case 91:return 91===i||61===i?function(){var e=A,t=w,n=z(!1);!1===n&&V(b,m.expected,"[",b.value);return{type:c,value:B(n),line:e,lineStart:t,lastLine:A,lastLineStart:w,range:[E,g]}}():M("[");case 47:return a.integerDivision&&47===i?M("//"):M("/");case 38:case 124:if(!a.bitwiseOperators)break;case 42:case 94:case 37:case 44:case 123:case 125:case 93:case 40:case 41:case 59:case 35:case 45:case 43:return M(t.charAt(g))}return G(t.charAt(g))}function F(){var e=t.charCodeAt(g),n=t.charCodeAt(g+1);return!!Y(e)&&(10===e&&13===n&&++g,13===e&&10===n&&++g,++A,w=++g,!0)}function P(){for(;g<r;){if(Q(t.charCodeAt(g)))++g;else if(!F())break}}function W(e){return e<128?String.fromCharCode(e):e<2048?String.fromCharCode(192|e>>6,128|63&e):e<65536?String.fromCharCode(224|e>>12,128|e>>6&63,128|63&e):e<1114112?String.fromCharCode(240|e>>18,128|e>>12&63,128|e>>6&63,128|63&e):null}function B(e){return e.replace(/[\ud800-\udbff][\udc00-\udfff]|[^\x00-\x7f]/g,function(e){return 1===e.length?W(e.charCodeAt(0)):W(65536+((1023&e.charCodeAt(0))<<10|1023&e.charCodeAt(1)))})}function M(e){return g+=e.length,{type:f,value:e,line:A,lineStart:w,range:[E,g]}}function R(){var e=t.charAt(g),n=t.charAt(g+1),r="0"===e&&"xX".indexOf(n||null)>=0?function(){var e,n,r,a,i=0,o=1,c=1;a=g+=2,$(t.charCodeAt(g))||V({},m.malformedNumber,t.slice(E,g));for(;$(t.charCodeAt(g));)++g;if(e=parseInt(t.slice(a,g),16),"."===t.charAt(g)){for(n=++g;$(t.charCodeAt(g));)++g;i=t.slice(n,g),i=n===g?0:parseInt(i,16)/Math.pow(16,g-n)}if("pP".indexOf(t.charAt(g)||null)>=0){for(++g,"+-".indexOf(t.charAt(g)||null)>=0&&(c="+"===t.charAt(g++)?1:-1),r=g,Z(t.charCodeAt(g))||V({},m.malformedNumber,t.slice(E,g));Z(t.charCodeAt(g));)++g;o=t.slice(r,g),o=Math.pow(2,o*c)}return(e+i)*o}():function(){for(;Z(t.charCodeAt(g));)++g;if("."===t.charAt(g))for(++g;Z(t.charCodeAt(g));)++g;if("eE".indexOf(t.charAt(g)||null)>=0)for(++g,"+-".indexOf(t.charAt(g)||null)>=0&&++g,Z(t.charCodeAt(g))||V({},m.malformedNumber,t.slice(E,g));Z(t.charCodeAt(g));)++g;return parseFloat(t.slice(E,g))}();return{type:l,value:r,line:A,lineStart:w,range:[E,g]}}function U(){var e=g;switch(t.charAt(g)){case"a":return++g,"";case"n":return++g,"\n";case"r":return++g,"\r";case"t":return++g,"\t";case"v":return++g,"\v";case"b":return++g,"\b";case"f":return++g,"\f";case"\r":case"\n":return F(),"\n";case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;Z(t.charCodeAt(g))&&g-e<3;)++g;var n=parseInt(t.slice(e,g),10);return n>255&&V({},m.decimalEscapeTooLarge,"\\"+n),String.fromCharCode(n);case"z":if(a.skipWhitespaceEscape)return++g,P(),"";case"x":if(a.hexEscapes){if($(t.charCodeAt(g+1))&&$(t.charCodeAt(g+2)))return g+=3,String.fromCharCode(parseInt(t.slice(e+1,g),16));V({},m.hexadecimalDigitExpected,"\\"+t.slice(e,g+2))}case"u":if(a.unicodeEscapes)return function(){var e=g++;for("{"!==t.charAt(g++)&&V({},m.braceExpected,"{","\\"+t.slice(e,g)),$(t.charCodeAt(g))||V({},m.hexadecimalDigitExpected,"\\"+t.slice(e,g));48===t.charCodeAt(g);)++g;for(var n=g;$(t.charCodeAt(g));)++g-n>6&&V({},m.tooLargeCodepoint,"\\"+t.slice(e,g));var r=t.charAt(g++);"}"!==r&&('"'===r||"'"===r?V({},m.braceExpected,"}","\\"+t.slice(e,g--)):V({},m.hexadecimalDigitExpected,"\\"+t.slice(e,g)));var a=parseInt(t.slice(n,g-1),16);return null===(a=W(a))&&V({},m.tooLargeCodepoint,"\\"+t.slice(e,g)),a}();default:a.strictEscapes&&V({},m.invalidEscape,"\\"+t.slice(e,g+1));case"\\":case'"':case"'":return t.charAt(g++)}}function q(){E=g,g+=2;var e=t.charAt(g),a="",i=!1,o=g,c=w,s=A;if("["===e&&(!1===(a=z(!0))?a=e:i=!0),!i){for(;g<r&&!Y(t.charCodeAt(g));)++g;n.comments&&(a=t.slice(o,g))}if(n.comments){var u=v.comment(a,t.slice(E,g));n.locations&&(u.loc={start:{line:s,column:E-c},end:{line:A,column:g-w}}),n.ranges&&(u.range=[E,g]),n.onCreateNode&&n.onCreateNode(u),C.push(u)}}function z(e){var n,a=0,i="",o=!1,c=A;for(++g;"="===t.charAt(g+a);)++a;if("["!==t.charAt(g+a))return!1;for(g+=a+1,Y(t.charCodeAt(g))&&F(),n=g;g<r;){for(;Y(t.charCodeAt(g));)F();if("]"===t.charAt(g++)){o=!0;for(var s=0;s<a;++s)"="!==t.charAt(g+s)&&(o=!1);"]"!==t.charAt(g+a)&&(o=!1)}if(o)return i+=t.slice(n,g-1),g+=a+1,i}V({},e?m.unfinishedLongComment:m.unfinishedLongString,c,"<eof>")}function J(){x=b,b=S,S=K()}function X(e){return e===b.value&&(J(),!0)}function H(e){e===b.value?J():V(b,m.expected,e,b.value)}function Q(e){return 9===e||32===e||11===e||12===e}function Y(e){return 10===e||13===e}function Z(e){return e>=48&&e<=57}function $(e){return e>=48&&e<=57||e>=97&&e<=102||e>=65&&e<=70}function _(e){return e>=65&&e<=90||e>=97&&e<=122||95===e||e>=48&&e<=57||!!(n.extendedIdentifiers&&e>=128)}function ee(e){if(o===e.type)return!0;if(s!==e.type)return!1;switch(e.value){case"else":case"elseif":case"end":case"until":return!0;default:return!1}}function te(){var e=Array.apply(null,k[L++]);k.push(e),n.onCreateScope&&n.onCreateScope()}function ne(){k.pop();L--,n.onDestroyScope&&n.onDestroyScope()}function re(e){n.onLocalDeclaration&&n.onLocalDeclaration(e),-1===N(k[L],e)&&k[L].push(e)}function ae(e){re(e.name),ie(e,!0)}function ie(e,t){t||-1!==function(e,t,n){for(var r=0,a=e.length;r<a;++r)if(e[r][t]===n)return r;return-1}(O,"name",e.name)||O.push(e),e.isLocal=t}function oe(e){return-1!==N(k[L],e)}e.lex=K;var ce,se=[];function ue(){return new le(b)}function le(e){n.locations&&(this.loc={start:{line:e.line,column:e.range[0]-e.lineStart},end:{line:0,column:0}}),n.ranges&&(this.range=[e.range[0],0])}function fe(){ce&&se.push(ue())}function pe(e){ce&&se.push(e)}function de(e){for(var t,n=[];!ee(b);){if("return"===b.value){n.push(he());break}t=he(),X(";"),t&&n.push(t)}return n}function he(){if(fe(),s===b.type)switch(b.value){case"local":return J(),function(){var e;if(u===b.type){var t=[],r=[];do{e=ye(),t.push(e)}while(X(","));if(X("="))do{var a=Se();r.push(a)}while(X(","));if(n.scope)for(var i=0,o=t.length;i<o;++i)ae(t[i]);return y(v.localStatement(t,r))}if(X("function"))return e=ye(),n.scope&&(ae(e),te()),ge(e,!0);j("<name>",b)}();case"if":return J(),function(){var e,t,r,a=[];ce&&(r=se[se.length-1],se.push(r));e=Se(),H("then"),n.scope&&te();t=de(),n.scope&&ne();a.push(y(v.ifClause(e,t))),ce&&(r=ue());for(;X("elseif");)pe(r),e=Se(),H("then"),n.scope&&te(),t=de(),n.scope&&ne(),a.push(y(v.elseifClause(e,t))),ce&&(r=ue());X("else")&&(ce&&(r=new le(x),se.push(r)),n.scope&&te(),t=de(),n.scope&&ne(),a.push(y(v.elseClause(t))));return H("end"),y(v.ifStatement(a))}();case"return":return J(),function(){var e=[];if("end"!==b.value){var t=xe();for(null!=t&&e.push(t);X(",");)t=Se(),e.push(t);X(";")}return y(v.returnStatement(e))}();case"function":return J(),ge(function(){var e,t,r;ce&&(r=ue());e=ye(),n.scope&&(ie(e,oe(e.name)),te());for(;X(".");)pe(r),t=ye(),e=y(v.memberExpression(e,".",t));X(":")&&(pe(r),t=ye(),e=y(v.memberExpression(e,":",t)),n.scope&&re("self"));return e}());case"while":return J(),function(){var e=Se();H("do"),n.scope&&te();var t=de();n.scope&&ne();return H("end"),y(v.whileStatement(e,t))}();case"for":return J(),function(){var e,t=ye();n.scope&&(te(),ae(t));if(X("=")){var r=Se();H(",");var a=Se(),i=X(",")?Se():null;return H("do"),e=de(),H("end"),n.scope&&ne(),y(v.forNumericStatement(t,r,a,i,e))}for(var o=[t];X(",");)t=ye(),n.scope&&ae(t),o.push(t);H("in");var c=[];do{var s=Se();c.push(s)}while(X(","));return H("do"),e=de(),H("end"),n.scope&&ne(),y(v.forGenericStatement(o,c,e))}();case"repeat":return J(),function(){n.scope&&te();var e=de();H("until");var t=Se();n.scope&&ne();return y(v.repeatStatement(t,e))}();case"break":return J(),y(v.breakStatement());case"do":return J(),function(){n.scope&&te();var e=de();n.scope&&ne();return H("end"),y(v.doStatement(e))}();case"goto":return J(),me()}return a.contextualGoto&&b.type===u&&"goto"===b.value&&S.type===u&&"goto"!==S.value?(J(),me()):f===b.type&&X("::")?function(){var e=b.value,t=ye();n.scope&&(re("::"+e+"::"),ie(t,!0));return H("::"),y(v.labelStatement(t))}():(ce&&se.pop(),a.emptyStatement&&X(";")?void 0:function(){var e,t,n=b;ce&&(t=ue());if(null==(e=Ee()))return G(b);if(",=".indexOf(b.value)>=0){var r,a=[e],i=[];for(ve(e);X(",");)null==(r=Ee())&&j("<expression>",b),ve(r),a.push(r);H("=");do{r=Se(),i.push(r)}while(X(","));return pe(t),y(v.assignmentStatement(a,i))}if(function(e){switch(e.type){case"CallExpression":case"TableCallExpression":case"StringCallExpression":return!0}return!1}(e))return pe(t),y(v.callStatement(e));return G(n)}())}function me(){b.value;var e=ye();return y(v.gotoStatement(e))}function ve(e){(e.inParens||-1===["Identifier","MemberExpression","IndexExpression"].indexOf(e.type))&&V(b,m.invalidVar,b.value)}function ye(){fe();var e=b.value;return u!==b.type&&j("<name>",b),J(),y(v.identifier(e))}function ge(e,t){var r=[];if(H("("),!X(")"))for(;;)if(u===b.type){var a=ye();if(n.scope&&ae(a),r.push(a),X(","))continue;if(X(")"))break}else{if(h===b.type){r.push(we()),H(")");break}j("<name> or '...'",b)}var i=de();return H("end"),n.scope&&ne(),t=t||!1,y(v.functionStatement(e,r,t,i))}function be(){for(var e,t,n=[];;){if(fe(),f===b.type&&X("["))e=Se(),H("]"),H("="),t=Se(),n.push(y(v.tableKey(e,t)));else if(u===b.type)"="===S.value?(e=ye(),J(),t=Se(),n.push(y(v.tableKeyString(e,t)))):(t=Se(),n.push(y(v.tableValue(t))));else{if(null==(t=xe())){se.pop();break}n.push(y(v.tableValue(t)))}if(!(",;".indexOf(b.value)>=0))break;J()}return H("}"),y(v.tableConstructorExpression(n))}function xe(){return function e(t){var n,r,a=b.value;ce&&(r=ue());if(function(e){return f===e.type?"#-~".indexOf(e.value)>=0:s===e.type&&"not"===e.value}(b)){fe(),J();var i=e(10);null==i&&j("<expression>",b),n=y(v.unaryExpression(a,i))}null==n&&null==(n=we())&&(n=Ee());if(null==n)return null;var o;for(;a=b.value,!(0===(o=f===b.type||s===b.type?Ce(a):0)||o<=t);){"^"!==a&&".."!==a||o--,J();var c=e(o);null==c&&j("<expression>",b),ce&&se.push(r),n=y(v.binaryExpression(a,n,c))}return n}(0)}function Se(){var e=xe();if(null!=e)return e;j("<expression>",b)}function Ce(e){var t=e.charCodeAt(0),n=e.length;if(1===n)switch(t){case 94:return 12;case 42:case 47:case 37:return 10;case 43:case 45:return 9;case 38:return 6;case 126:return 5;case 124:return 4;case 60:case 62:return 3}else if(2===n)switch(t){case 47:return 10;case 46:return 8;case 60:case 62:return"<<"===e||">>"===e?7:3;case 61:case 126:return 3;case 111:return 1}else if(97===t&&"and"===e)return 2;return 0}function Ee(){var e,t,r,a,i;if(ce&&(r=ue()),u===b.type)t=b.value,e=ye(),n.scope&&ie(e,oe(t));else{if(!X("("))return null;e=Se(),H(")"),e.inParens=!0}for(;;)if(f===b.type)switch(b.value){case"[":pe(r),J(),a=Se(),H("]"),e=y(v.indexExpression(e,a));break;case".":pe(r),J(),i=ye(),e=y(v.memberExpression(e,".",i));break;case":":pe(r),J(),i=ye(),e=y(v.memberExpression(e,":",i)),pe(r),e=Ae(e);break;case"(":case"{":pe(r),e=Ae(e);break;default:return e}else{if(c!==b.type)break;pe(r),e=Ae(e)}return e}function Ae(e){if(f===b.type)switch(b.value){case"(":a.emptyStatement||b.line!==x.line&&V({},m.ambiguousSyntax,b.value),J();var t=[],n=xe();for(null!=n&&t.push(n);X(",");)n=Se(),t.push(n);return H(")"),y(v.callExpression(e,t));case"{":fe(),J();var r=be();return y(v.tableCallExpression(e,r))}else if(c===b.type)return y(v.stringCallExpression(e,we()));j("function arguments",b)}function we(){var e,r=c|l|p|d|h,a=b.value,i=b.type;if(ce&&(e=ue()),i&r){pe(e);var o=t.slice(b.range[0],b.range[1]);return J(),y(v.literal(i,a,o))}return s===i&&"function"===a?(pe(e),J(),n.scope&&te(),ge(null)):X("{")?(pe(e),be()):void 0}le.prototype.complete=function(){n.locations&&(this.loc.end.line=x.lastLine||x.line,this.loc.end.column=x.range[1]-(x.lastLineStart||x.lineStart)),n.ranges&&(this.range[1]=x.range[1])},le.prototype.bless=function(e){if(this.loc){var t=this.loc;e.loc={start:{line:t.start.line,column:t.start.column},end:{line:t.end.line,column:t.end.column}}}this.range&&(e.range=[this.range[0],this.range[1]])},e.parse=function(o,c){void 0===c&&"object"==typeof o&&(c=o,o=void 0);c||(c={});if(t=o||"",n=function(){for(var e,t,n=I.call(arguments),r={},a=0,i=n.length;a<i;++a)for(t in e=n[a])e.hasOwnProperty(t)&&(r[t]=e[t]);return r}(i,c),g=0,A=1,w=0,r=t.length,k=[[]],L=0,O=[],se=[],!(a=ke[n.luaVersion]))throw new Error(T("Lua version '%1' not supported",n.luaVersion));n.comments&&(C=[]);return n.wait?e:Oe()};var ke={5.1:{},5.2:{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0},5.3:{labels:!0,emptyStatement:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0,bitwiseOperators:!0,integerDivision:!0},LuaJIT:{labels:!0,contextualGoto:!0,hexEscapes:!0,skipWhitespaceEscape:!0,strictEscapes:!0,unicodeEscapes:!0}};function Le(n){return t+=String(n),r=t.length,e}function Oe(e){void 0!==e&&Le(e),t&&"#!"===t.substr(0,2)&&(t=t.replace(/^.*/,function(e){return e.replace(/./g," ")})),r=t.length,ce=n.locations||n.ranges,S=K();var a=function(){J(),fe(),n.scope&&te();var e=de();return n.scope&&ne(),o!==b.type&&G(b),ce&&!e.length&&(x=b),y(v.chunk(e))}();if(n.comments&&(a.comments=C),n.scope&&(a.globals=O),se.length>0)throw new Error("Location tracking failed. This is most likely a bug in luaparse");return a}e.write=Le,e.end=Oe});